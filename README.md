<!--
╔════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                    ║
║   Copyright (c) 2020 https://prrvchr.github.io                                     ║
║                                                                                    ║
║   Permission is hereby granted, free of charge, to any person obtaining            ║
║   a copy of this software and associated documentation files (the "Software"),     ║
║   to deal in the Software without restriction, including without limitation        ║
║   the rights to use, copy, modify, merge, publish, distribute, sublicense,         ║
║   and/or sell copies of the Software, and to permit persons to whom the Software   ║
║   is furnished to do so, subject to the following conditions:                      ║
║                                                                                    ║
║   The above copyright notice and this permission notice shall be included in       ║
║   all copies or substantial portions of the Software.                              ║
║                                                                                    ║
║   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,                  ║
║   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES                  ║
║   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.        ║
║   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY             ║
║   CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,             ║
║   TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE       ║
║   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                                    ║
║                                                                                    ║
╚════════════════════════════════════════════════════════════════════════════════════╝
-->
# [![SQLite-JDBC logo][1]][2] Documentation

**Ce [document][3] en français.**

# version [3.45.1.6-SNAPSHOT][4]

## Introduction:

**SQLite-JDBC** was born from a fork of xerial [sqlite-jdbc][5] following a refusal to merge a [pull request][6] to make the SQLite driver compatible with JDBC 4.1.

This driver allows you to use software compatible with JDBC 4.1 and SQLite database.

Its operation does not really differ from the original driver and here are the modifications that were necessary:
- A result set (ResultSet) is cached when executing SQL `INSERT` or `REPLACE` queries using the methods:
     - `java.sql.Statement.executeUpdate(String sql, int autoGeneratedKeys)`
     - `java.sql.Statement.executeUpdate(String sql, String[] columnNames)`
     - `java.sql.PreparedStatement.executeUpdate()` if the necessary options during its creation have been provided.
- SQL commands starting with `INSERT ` or `REPLACE ` will be supplemented with the `RETURNING` clause to which are added the necessary options to obtain the cached result set.
- The result set cached when executing one of the `executeUpdate()` methods is returned when the `java.sql.Statement.getGeneratedKeys()` method is called.

These modifications only concern the internal functioning of the driver and are not visible.  
On the other hand, to make them functional it was necessary to modify certain access methods to the JDBC SQLite driver and here is the list:
- `java.sql.DatabaseMetaData.supportsGetGeneratedKeys()` method answers `true`.
- `java.sql.DatabaseMetaData.generatedKeyAlwaysReturned()` method answers `false`.
- `java.sql.Statement.executeUpdate(String sql, int autoGeneratedKeys)` method works as follows:
  - If _autoGeneratedKeys_ is equal to `java.sql.Statement.RETURN_GENERATED_KEYS` and the SQL command begins with `INSERT` or `REPLACE` and it only includes one SQL command then the records affected by the SQL command will be accessible by the `java.sql.Statement.getGeneratedKeys()` method (all columns in the table will be returned).
  - Otherwise the SQL command will be executed without influencing the operation of `getGenerateKeys()` which allows you to interweave queries before having to retrieve the records using `getGeneratedKeys()`...
- `java.sql.Statement.executeLargeUpdate(String sql, int autoGeneratedKeys)` method works like the previous one...
- `java.sql.Statement.executeUpdate(String sql, String[] columnNames)` method allows you to get only the requested _columnNames_ in `getGeneratedKeys()`.
- `java.sql.Statement.executeLargeUpdate(String sql, String[] columnNames)` method works like the previous one...
- `java.sql.Statement.executeUpdate(String sql, int[] columnIndex)` method is not supported.
- `java.sql.Statement.executeLargeUpdate(String sql, int[] columnIndex)` method is not supported.
- `java.sql.Statement.execute(String sql, int autoGeneratedKeys)` method is a no ops, it clear any generated keys and calls `execute(String sql)`. You need to use `executeUpdate(String sql, int autoGeneratedKeys)` then `getGeneratedKeys()` methods.
- `java.sql.Statement.execute(String sql, String[] columnNames)` method is a no ops, it clear any generated keys and calls `execute(String sql)`. You need to use `executeUpdate(String sql, String[] columnNames)` then `getGeneratedKeys()` methods.
- `java.sql.Statement.execute(String sql, int[] columnIndex)` method is not supported.
- `java.sql.Connection.prepareStatement(String sql,  int autoGeneratedKeys)` method work same as `executeUpdate(String sql, int autoGeneratedKeys)` concerning the use of `getGeneratedKeys()` which must however be accessed after each call to the `executeUpdate()` or `executeLargeUpdate()` method.
- `java.sql.Connection.prepareStatement(String sql,  String[] columnNames)` method work same as `executeUpdate(String sql, String[] columnNames)` concerning the use of `getGeneratedKeys()` which must however be accessed after each call to the `executeUpdate()` or `executeLargeUpdate()` method.
- `java.sql.Connection.prepareStatement(String sql, int[] columnIndex)` method is not supported.
- `java.sql.PreparedStatement.executeUpdate()` method allows access to the `getGeneratedKeys()` method if the prepared statement was created with the necessary options. The `getGeneratedKeys()` method must however be accessed after each call to the `executeUpdate()` or `executeLargeUpdate()` method.
- `java.sql.PreparedStatement.executeLargeUpdate()` method works like the previous one...
- `java.sql.PreparedStatement.execute()` method is a no ops, it clear any generated keys and calls `execute()`. You need to use `executeUpdate()` then `getGeneratedKeys()` methods.
- `java.sql.PreparedStatement.executeQuery()` method is a no ops, it clear any generated keys and calls `executeQuery()`. You need to use `executeUpdate()` then `getGeneratedKeys()` methods.

I would like to point out that this new mode of operation of the driver is not quite the same as that used in the gotson driver. This may require changing some SQL queries in your programs. **But it assures you that its use complies with JDBC 4.1 standards**.

Being free software I encourage you:
- To duplicate its [source code][7].
- To make changes, corrections, improvements.
- To open [issue][8] if needed.

In short, to participate in the development of this extension.  
Because it is together that we can make Free Software smarter.

___

## Installation:

Download the jar archive and do what you like.

- ![SQLite-JDBC logo][1] jar file **[sqlite-jdbc-3.45.1.6-SNAPSHOT.jar][9]** [![Version][10]][9]

[1]: <https://prrvchr.github.io/SQLiteOOo/img/sqlite.svg#collapse>
[2]: <https://prrvchr.github.io/sqlite-jdbc/>
[3]: <https://prrvchr.github.io/sqlite-jdbc/README_fr>
[4]: <https://github.com/prrvchr/sqlite-jdbc/releases>
[5]: <https://github.com/xerial/sqlite-jdbc>
[6]: <https://github.com/xerial/sqlite-jdbc/pull/1067>
[7]: <https://github.com/prrvchr/sqlite-jdbc/>
[8]: <https://github.com/prrvchr/sqlite-jdbc/issues/new>
[9]: <https://github.com/prrvchr/sqlite-jdbc/releases/download/3.45.1.6-SNAPSHOT/sqlite-jdbc-3.45.1.6-SNAPSHOT.jar>
[10]: <https://img.shields.io/github/downloads/prrvchr/sqlite-jdbc/total?label=v3.45.1.6-SNAPSHOT#right>
