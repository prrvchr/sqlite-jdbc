<!--
╔════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                    ║
║   Copyright (c) 2020 https://prrvchr.github.io                                     ║
║                                                                                    ║
║   Permission is hereby granted, free of charge, to any person obtaining            ║
║   a copy of this software and associated documentation files (the "Software"),     ║
║   to deal in the Software without restriction, including without limitation        ║
║   the rights to use, copy, modify, merge, publish, distribute, sublicense,         ║
║   and/or sell copies of the Software, and to permit persons to whom the Software   ║
║   is furnished to do so, subject to the following conditions:                      ║
║                                                                                    ║
║   The above copyright notice and this permission notice shall be included in       ║
║   all copies or substantial portions of the Software.                              ║
║                                                                                    ║
║   THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,                  ║
║   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES                  ║
║   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.        ║
║   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY             ║
║   CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,             ║
║   TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE       ║
║   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                                    ║
║                                                                                    ║
╚════════════════════════════════════════════════════════════════════════════════════╝
-->
# [![SQLite-JDBC logo][1]][2] Documentation

**This [document][3] in English.**

# version [3.45.1.6-SNAPSHOT][4]

## Introduction:

**SQLite-JDBC** est né d'un fork de xerial [sqlite-jdbc][5] suite à un refus de fusionner une [demande de changement][6] pour rendre le pilote SQLite compatible avec JDBC 4.1.

Ce pilote vous permet d'utiliser un logiciel compatible avec JDBC 4.1 et la base de données SQLite.

Son fonctionnement ne diffère pas vraiment du pilote d'origine et voici les modifications qui ont été nécessaires :
- Un jeu de résultats (ResultSet) est mis en cache lors de l'exécution de requêtes SQL `INSERT` ou `REPLACE` par les méthodes :
    - `java.sql.Statement.executeUpdate (String sql, int autoGeneratedKeys)`
    - `java.sql.Statement.executeUpdate (String sql, String[] columnNames)`
    - `java.sql.PreparedStatement.executeUpdate()` si les options nécessaires lors de sa création ont été fournies.
- Les commandes SQL commençant par `INSERT ` ou `REPLACE ` seront complétées par la clause `RETURNING` à laquelle sont ajoutées les options nécessaires pour obtenir le jeu de résultats mis en cache.
- Le jeu de résultats mis en cache lors de l'exécution de l'une des méthodes `executeUpdate()` est renvoyé lors de l'appel de la méthode `java.sql.Statement.getGeneratedKeys()`.

Ces modifications concernent uniquement le fonctionnement interne du pilote et ne sont pas visibles.  
En revanche, pour les rendre fonctionnels il a fallu modifier certaines méthodes d'accès au driver JDBC SQLite et dont voici la liste:
- La méthode `java.sql.DatabaseMetaData.supportsGetGeneratedKeys()` répond `true`.
- La méthode `java.sql.DatabaseMetaData.generatedKeyAlwaysReturned()` répond `false`.
- La méthode `java.sql.Statement.executeUpdate(String sql, int autoGeneratedKeys)` fonctionne comme suit :
   - Si _autoGeneratedKeys_ est égal à `java.sql.Statement.RETURN_GENERATED_KEYS` et que la commande SQL commence par `INSERT` ou `REPLACE` et qu'elle ne comprend qu'une seule commande SQL alors les enregistrements affectés par la commande SQL seront accessibles par méthode `java.sql.Statement.getGeneratedKeys()` (toutes les colonnes de la table seront renvoyées).
   - Sinon la commande SQL sera exécutée sans influencer le fonctionnement de `getGenerateKeys()` ce qui permet d'entrelacer les requêtes avant de devoir récupérer les enregistrements à l'aide de `getGeneratedKeys()`...
- La méthode `java.sql.Statement.executeLargeUpdate(String sql, int autoGeneratedKeys)` fonctionne comme la précédente...
- La méthode `java.sql.Statement.executeUpdate(String sql, String[] columnNames)` vous permet d'obtenir uniquement les _columnNames_ demandés dans `getGeneratedKeys()`.
- La méthode `java.sql.Statement.executeLargeUpdate(String sql, String[] columnNames)` fonctionne comme la précédente...
- La méthode `java.sql.Statement.executeUpdate(String sql, int[] columnIndex)` n'est pas prise en charge.
- La méthode `java.sql.Statement.executeLargeUpdate(String sql, int[] columnIndex)` n'est pas prise en charge.
- La méthode `java.sql.Statement.execute(String sql, int autoGeneratedKeys)` n'est pas opérationnelle, elle efface toutes les clés générées et appelle `execute(String sql)`. Vous devez utiliser les méthodes `executeUpdate(String sql, int autoGeneratedKeys)` puis `getGeneratedKeys()`.
- La méthode `java.sql.Statement.execute(String sql, String[] columnNames)` n'est pas opérationnelle, elle efface toutes les clés générées et appelle `execute(String sql)`. Vous devez utiliser les méthodes `executeUpdate(String sql, String[] columnNames)` puis `getGeneratedKeys()`.
- La méthode `java.sql.Statement.execute(String sql, int[] columnIndex)` n'est pas prise en charge.
- La méthode `java.sql.Connection.prepareStatement(String sql, int autoGeneratedKeys)` fonctionne de la même manière que `executeUpdate(String sql, int autoGeneratedKeys)` concernant l'utilisation de `getGeneratedKeys()` qui doit cependant être accédé après chaque appel au Méthode `executeUpdate()` ou `executeLargeUpdate()`.
- La méthode `java.sql.Connection.prepareStatement(String sql, String[] columnNames)` fonctionne de la même manière que `executeUpdate(String sql, String[] columnNames)` concernant l'utilisation de `getGeneratedKeys()` qui doit cependant être accédé après chaque appel à la méthode `executeUpdate()` ou `executeLargeUpdate()`.
- La méthode `java.sql.Connection.prepareStatement(String sql, int[] columnIndex)` n'est pas prise en charge.
- La méthode `java.sql.PreparedStatement.executeUpdate()` permet d'accéder à la méthode `getGeneratedKeys()` si la requête préparée a été créée avec les options nécessaires. La méthode `getGeneratedKeys()` doit cependant être accédée après chaque appel à la méthode `executeUpdate()` ou `executeLargeUpdate()`.
- La méthode `java.sql.PreparedStatement.executeLargeUpdate()` fonctionne comme la précédente...
- La méthode `java.sql.PreparedStatement.execute()` n'est pas opérationnelle, elle efface toutes les clés générées et appelle `execute()`. Vous devez utiliser les méthodes `executeUpdate()` puis `getGeneratedKeys()`.
- La méthode `java.sql.PreparedStatement.executeQuery()` n'est pas opérationnelle, elle efface toutes les clés générées et appelle `executeQuery()`. Vous devez utiliser les méthodes `executeUpdate()` puis `getGeneratedKeys()`.

Je tiens à souligner que ce nouveau mode de fonctionnement du pilote n'est pas tout à fait le même que celui utilisé dans le pilote xerial. Cela peut nécessiter la modification de certaines requêtes SQL dans vos programmes. **Mais il vous assure que son utilisation respecte les standards JDBC 4.1**.

Etant un logiciel libre je vous encourage:
- A dupliquer son [code source][7].
- A apporter des modifications, des corrections, des améliorations.
- D'ouvrir un [dysfonctionnement][8] si nécessaire.

Bref, à participer au developpement de cette extension.  
Car c'est ensemble que nous pouvons rendre le Logiciel Libre plus intelligent.

___

## Installation:

Télécharger l'archive jar et faite en ce qu'il vous plait.

- ![SQLite-JDBC logo][1] Fichier jar **[sqlite-jdbc-3.45.1.6-SNAPSHOT.jar][9]** [![Version][10]][9]

[1]: <https://prrvchr.github.io/SQLiteOOo/img/sqlite.svg#collapse>
[2]: <https://prrvchr.github.io/sqlite-jdbc/>
[3]: <https://prrvchr.github.io/sqlite-jdbc/>
[4]: <https://github.com/prrvchr/sqlite-jdbc/releases>
[5]: <https://github.com/xerial/sqlite-jdbc>
[6]: <https://github.com/xerial/sqlite-jdbc/pull/1067>
[7]: <https://github.com/prrvchr/sqlite-jdbc/>
[8]: <https://github.com/prrvchr/sqlite-jdbc/issues/new>
[9]: <https://github.com/prrvchr/sqlite-jdbc/releases/download/3.45.1.6-SNAPSHOT/sqlite-jdbc-3.45.1.6-SNAPSHOT.jar>
[10]: <https://img.shields.io/github/downloads/prrvchr/sqlite-jdbc/total?label=v3.45.1.6-SNAPSHOT#right>
